---
export interface Props {
  post?: any; // Add post prop for blog articles
}

const { post } = Astro.props;

const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  name: "IA Punto",
  url: "https://www.iapunto.com/",
  logo: "https://res.cloudinary.com/dkb9jfet8/image/upload/v1741038442/logo-v3-cuadrado_seljkv.jpg",
  description:
    "Soluciones de Inteligencia Artificial para optimizar procesos empresariales: marketing digital, automatización, desarrollo web y consultoría estratégica.",
  address: {
    "@type": "PostalAddress",
    streetAddress: "Krr 16D #2-14",
    addressLocality: "Bucaramanga",
    addressRegion: "Santander",
    postalCode: "680001",
    addressCountry: "CO",
  },
  contactPoint: {
    "@type": "ContactPoint",
    telephone: "+57-316-376-9935",
    contactType: "Ventas y Soporte técnico",
  },
};

let combinedSchema = [organizationSchema];

if (post) {
  const articleSchema = {
    "@context": "https://schema.org",
    "@type": "Article",
    headline: post.data.title,
    image: post.data.cover, // Assuming cover is the main image for the article
    datePublished: post.data.pubDate.toISOString(),
    dateModified: post.data.pubDate.toISOString(), // Assuming no separate modified date
    author: {
      "@type": "Person",
      name: post.data.author.name,
    },
    publisher: {
      "@type": "Organization",
      name: organizationSchema.name,
      logo: {
        "@type": "ImageObject",
        url: organizationSchema.logo,
      },
    },
    description: post.data.description,
    mainEntityOfPage: {
      "@type": "WebPage",
      "@id": Astro.url.href, // Current page URL
    },
  };
  combinedSchema.push(articleSchema);
}
---

<script type="application/ld+json">
  {JSON.stringify(combinedSchema.length === 1 ? combinedSchema[0] : combinedSchema)}
</script>